# Руководство по доступу к модулю IAM/Roles & Permissions

## Описание модуля
Модуль IAM (Identity and Access Management) / Roles & Permissions предназначен для управления ролями, разрешениями и контролем доступа в системе GTS.

## Пути доступа к модулю

### 1. Через Executive Dashboard (Рекомендуемый)
1. Войдите в систему как пользователь с ролью `Executive` или `SysAdmin`
2. Перейдите на главную страницу Dashboard
3. В разделе "Системное управление" нажмите на кнопку **IAM** (с иконкой щита)
4. Вы будете перенаправлены в модуль управления ролями и разрешениями

### 2. Прямая навигация через URL
- Добавьте в хук навигации: `navigateToModule('iam')`
- Или используйте `setCurrentPage('iam')` в состоянии приложения

### 3. Программный доступ
```typescript
// В любом компоненте с доступом к навигации
const handleNavigateToIAM = () => {
  navigateToModule('iam');
};
```

## Требования к доступу

### Роли с полным доступом:
- **Executive** - полные права управления ролями, разрешениями и пользователями
- **SysAdmin** - полные права управления системой и безопасностью

### Роли с ограниченным доступом:
- **Finance** - только просмотр журнала аудита
- **Marketing** - только просмотр ролей (без редактирования)
- **Staff** - только просмотр назначенных ролей

### Недоступно для:
- Клиентские роли (User, Bronze, Silver, Gold, Platinum)
- Партнерские роли (Partner-Agent, Partner-Contractor, Partner-Brand)
- Операционные роли без административных прав

## Функциональность модуля

### 1. Матрица разрешений
- Таблица с ролями и модулями системы
- Переключатели для действий: View, Create, Edit, Delete, Approve
- Предупреждения для критических изменений

### 2. Управление ролями
- Список всех ролей с фильтрацией по категориям
- Детальные карточки ролей с настройками scope (Global/Location/Own)
- Управление участниками ролей

### 3. Журнал аудита
- Полная история изменений ролей и разрешений
- Фильтрация по уровню критичности
- Информация о том, кто и когда внес изменения

## Компоненты системы

### Модули под управлением IAM:
- **CRM** - Управление клиентами и лидами
- **Calendar** - Глобальный календарь бронирований
- **SphereM** - Sphere Management
- **Partners** - База данных партнеров
- **Staff** - Управление персоналом
- **Finance** - Финансовый центр
- **Docs** - Документы и входящие
- **CMS** - Система управления контентом

### Поддерживаемые действия:
- **View** - Просмотр
- **Create** - Создание
- **Edit** - Редактирование
- **Delete** - Удаление
- **Approve** - Утверждение

## Структура ролей

### Клиентские роли
- User, Bronze, Silver, Gold, Platinum

### Персонал
- Operator, Dispatcher, SiteAdmin, Captain, Pilot, Guide, Mechanic, Support

### Управление
- Marketing, Finance, Executive, SysAdmin

### Партнеры
- Partner-Agent, Partner-Contractor, Partner-Brand

### B2B
- B2B Client, B2B Manager

## Безопасность

- Все критические изменения записываются в журнал аудита
- Предупреждения при изменении разрешений для критичных ролей
- Проверка прав доступа на уровне компонентов
- Автоматическое отслеживание сеансов и действий пользователей

## Техническая информация

### Расположение файлов:
- Основной компонент: `/components/admin/modules/GTSIAMRolesPermissions.tsx`
- Роутер: `/components/pages/GTSPageRouter.tsx`
- Навигация: `/utils/navigation.ts`
- Хук навигации: `/hooks/useNavigation.ts`

### Зависимости:
- Дизайн-система GTS
- shadcn/ui компоненты
- Lucide React иконки
- Tailwind CSS с GTS темами

---

*Последнее обновление: декабрь 2024*